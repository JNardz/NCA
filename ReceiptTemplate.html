<!DOCTYPE html>
<html>
<head>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap');
    
    body { font-family: 'Open Sans', sans-serif; font-size: 12px; color: #333; padding: 20px; }
    
    /* Layout Structures */
    .header-grid { display: flex; justify-content: space-between; margin-bottom: 20px; border-bottom: 2px solid #333; padding-bottom: 10px; }
    .header-left { flex: 1; }
    .header-right { text-align: right; }
    
    .info-row { margin-bottom: 5px; }
    .label { font-weight: bold; color: #555; margin-right: 5px; }
    
    /* Table Styling */
    table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
    th { text-align: left; border-bottom: 2px solid #000; padding: 5px; white-space: nowrap; }
    td { border-bottom: 1px solid #eee; padding: 8px 5px; vertical-align: top; }
    
    /* Column Widths (Approximate based on description) */
    .col-title { width: 10%; }
    .col-id { width: 15%; font-weight: bold; }
    .col-desc { width: 35%; }
    .col-vin { width: 25%; }
    .col-res { width: 15%; text-align: right; }

    /* Footer & End Blocks */
    .end-block { margin-top: 30px; border: 1px solid #ddd; padding: 15px; page-break-inside: avoid; background: #f9f9f9; }
    .sig-grid { display: flex; justify-content: space-between; align-items: flex-end; margin-top: 20px; }
    .sig-line { border-top: 1px solid #333; width: 250px; text-align: center; padding-top: 5px; margin-top: 40px; }
    .sig-img { max-height: 60px; max-width: 200px; display: block; margin-bottom: -10px; }

    /* Print Specifics */
    @media print {
      thead { display: table-header-group; } 
      tfoot { display: table-footer-group; }
    }

    /* Fixed Footer Simulation for GAS PDF */
    #page-footer { position: fixed; bottom: 0; width: 100%; text-align: right; font-size: 10px; color: #777; border-top: 1px solid #ccc; padding-top: 5px; }
  </style>
</head>
<body>

  <div id="page-footer">
    Receipt Generated: <?= new Date().toLocaleString() ?> | Page 
  </div>

  <table>
    <thead>
      <tr>
        <td colspan="5">
          <div class="header-grid">
            <div class="header-left">
              <div class="info-row"><span class="label">CONSIGNOR ID:</span> <?= data.consignorId ?></div>
              <div class="info-row" style="font-size:1.2em; font-weight:bold; margin: 10px 0;"><?= headerName ?></div>
              <div class="info-row"><span class="label">ADDRESS:</span> <?= data.address ?></div>
            </div>
            <div class="header-right">
              <div class="info-row"><span class="label">DATE:</span> <?= date ?></div>
              <div class="info-row"><span class="label">PHONE:</span> <?= data.phone ?></div>
            </div>
          </div>
          <div style="display:flex; border-bottom:2px solid black; font-weight:bold; padding:5px 0;">
            <div class="col-title">Title Status</div>
            <div class="col-id">Inventory ID</div>
            <div class="col-desc">Item Name</div>
            <div class="col-vin">VIN / SN</div>
            <div class="col-res">Reserve</div>
          </div>
        </td>
      </tr>
    </thead>

    <tbody>
      <? for (var i = 0; i < data.items.length; i++) { 
           var item = data.items[i]; 
      ?>
        <tr>
          <td class="col-title"><?= item.title || "" ?></td>
          <td class="col-id">#<?= item.generatedId ?></td>
          <td class="col-desc"><?= item.desc || "" ?></td>
          <td class="col-vin"><?= item.vin ? "VIN/SN: " + item.vin : "" ?></td>
          <td class="col-res"><?= item.reserve ? "$" + item.reserve : "" ?></td>
        </tr>
      <? } ?>
      
      <tr>
        <td colspan="5">
          <div class="end-block">
            <div style="font-weight:bold; border-bottom:1px solid #ccc; padding-bottom:5px; margin-bottom:10px;">Authorization & Acknowledgement</div>
            
            <div class="sig-grid">
              <div>
                <span class="label">Signature:</span>
                <? if (data.signatureImage) { ?>
                  <img src="<?= data.signatureImage ?>" class="sig-img">
                <? } ?>
                <div class="sig-line">
                  <?= data.signatureName || "Owner / Agent" ?>
                </div>
              </div>

              <div style="text-align:right">
                <span class="label">Received By:</span>
                <div class="sig-line">
                  <?= data.user || "Intake Staff" ?>
                </div>
              </div>
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>

</body>
</html>
